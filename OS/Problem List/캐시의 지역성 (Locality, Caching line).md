# 캐시의 지역성 (Locality, Caching line)

## 김민수

### 캐시의 지역성

캐시가 효율적으로 동작하려면 저장할 데이터가 지역성을 가져야 한다. 캐시의 성능은 적중률 (Hit ratio)에 의해 결정된다.

> 적중률 Hit ratio
>
> 캐시 메모리 적중 횟수 / 전체 메모리 참조 횟수. 실패율은 1 - 적중율이다.

- 시간적 지역성

  특정 데이터가 한번 접근되었을 경우, 가까운 미래에 다시 접근될 확률이 높은 것을 말한다.

  e.g LRU, 공통 변수

- 공간적 지역성

  특정 데이터와 가까운 주소가 순서대로 접근되는 경우를 말한다. 이때 특정 데이터 뿐만 아니라 주변 블럭 전체를 캐싱하여 성능을 높힌다. 

  e.g for 문과 같은 순차적 실행, 배열

- 순차적 지역성

  데이터가 순차적으로 접근되는 경향으로, 명령어들은 저장된 순서대로 인출되어 실행된다. 공간적 지역성에 포함되어 설명하기도 한다.

### Caching line

캐시 메모리는 메인 메모리에 비해 저장 공간이 매우 작다. 따라서 메인 메모리의 데이터를 캐시 메모리에 1대1 대응 시킬 수 없다. 또한 캐시 메모리의 데이터 위치를 특정하지 못하면 캐시 메모리 전체를 순회해야하기 때문에 성능이 나빠진다. 따라서 캐시메모리에 저장할 때, 특정 자료구조를 이용하여 데이터 묶음를 저장하는데 이를 캐싱라인이라 한다.

- Direct mapping

  직접 매핑으로, 메인 메모리를 일정한 크기의 블록으로 나눠 캐시의 정해진 위치에 블록 단위로 저장한다. 간단하며구현이 쉽다.

  하지만 적중율이 낮아 질 수 있고 같은 캐시 메모리 주소에 할당된 데이터를 사용할 때 충돌이 생길 수 있다.

  ![img](https://blog.kakaocdn.net/dn/KWMR2/btrgjyIn1ns/mvER1WQu1w7kI4BuHbQCqk/img.png)

- Full associative mapping

  캐시 메모리 공간에 임의로 저장하는 방법이다. 저장은 매우 쉬우나 데이터 탐색 시, 모든 태그를 병렬적으로 검사해야한다. 따라서 탐색 과정이 복잡하고 비용이 높다.

- Set associative mapping

  앞선 두가지 방식을 혼용한 방법으로 미리 정해둔 특정 위치들 중 임의로 저장한다. Direct mapping에 비해 검색 속도는 느리지만 저장이 빠르고 Full associative mapping 보단 저장이 느리지만 검색이 빠르다. 주로 사용하는 방법이다.

## 이수형

### 캐시의 지역성

캐시 메모리는 CPU가 어떤 데이터를 원할것인가에 대해 어느정도 예측할 수 있어야된다
이때 적중율을 극대화 시키기 위해서 사용되는것이 지역성의 원리이다.

시간의 지역성

- 현재 참조된 기억장소는 미래에도 계속 참조될 가능성이 높음

공간의 지역성

- 하나의 기억장소가 참조되면 근처의 기억장소가 계속 참조될 가능성이 높음

### Caching line

캐시가 아무리 가까이 있어도 찾고자 하는 데이터가 어느곳에 저장되어 있는지를 모른다면 효율적이지 않기 때문에 캐시에 데이터를 저장 할때는 태그의 묶음으로 저장하게 되고 이를 Caching line이라고 한다

1. Direct Mapping
   
   주기억장치의 블록들이 지정된 한 개의 캐시 라인으로 블록단위로 정해진 위치에 매핑 

   장점 : 구현이 쉽고 비용이 적음<br/>
   단점 : 적중률이 낮아질 수 있음, 동일한 인덱스 필드 값을 가진 다수의 메모리 주소를 함께 저장할 수 없음(address conflict)

2. Full Associative Mapping

   Direct Mapping의 단점을 보완한 방식 모든 태그들을 병렬로 검사
   
   단점 : 저장은 쉬우나 과정이 복잡함, 데이터에 특별한 순서가 없으므로 검색하는데 추가 비용이 많이 듦


3. Set Associative Mapping

    Direct Mapping과 Full Associative Mapping의 장점만을 취한 방식
    
    Direct Mapping에서 동일 인덱스 필드의 메모리 영역 데이터를 함께 공유할 수 없다는 단점을 극복하기 위해 마련되었음 
    
    여러 개의 set으로 구성되어있고 Main memory의 block들은 들어갈 set은 정해져있지만 set 내에서는 어디로 들어가든 상관 없음


저장속도 : Full Associative > Set Associative > Direct

검색속도 : Direct > Set Asoociative > Full Associative

## 윤기재

### 캐시(Cache)의 지역성(Locality)
- 캐시가 효율적으로 동작하려면, 캐시의 적중율(Hit-rate)를 극대화 시켜야 한다.
- 캐시에 저장할 데이터가 지역성(Locality)을 가져야 한다.
- 지역성의 전제 조건으로 프로그램은 모든 코드나 데이터를 균등하게 Access하지 않는다는 특성을 기본으로 한다.

> **지역성이란**
> 데이터 접근이 시간적, 혹은 공간적으로 가깝게 일어나는 것을 의미한다.
> 기억장치 내의 정보를 균일하게 Access하는 것이 아닌 어느 한 순간에 특정 부분을 집중적으로 참조하는 특성이다.

#### 지역성(Locality)의 종류
##### 시간적 지역성
- 특정 데이터가 한번 접근되었을 경우, 가까운 미래에 또 한번 데이터에 접근할 가능성이 높은 것
- 메모리 상의 같은 주소에 여러 차례 읽기 쓰기를 수행할 경우, 상대적으로 작은 크기의 캐시를 사용해도 효율성을 높일수있다.

##### 공간적 지역성
- 특정 데이터와 가까운 주소가 순서대로 접근되었을 경우.
- CPU 캐시나 디스크 캐시의 경우 한 메모리 주소에 접근할 때 그 주소뿐 아니라 해당 블록을 전부 캐시에 가져오게 된다.
- 이때 메모리 주소를 오름차순이나 내림차순으로 접근한다면,
- 캐시에 이미 저장된 같은 블록의 데이터를 접근하게 되므로 캐시의 효율성이 크게 향상된다.



### Caching line
캐시(cache)는 프로세서 가까이에 위치하면서 빈번하게 사용되는 데이터를 놔두는 장소이다. 따라서 캐시에 데이터를 저장할 때 특정 자료구조를 사용하여 묶음으로 저장하게 되는데 이를 캐싱 라인이라고 한다.

#### Direct Map
- 메인 메모리와 캐시를 똑같은 크기로 나누고 순서대로 매핑하는것
- 각 메모리 블록이 캐시의 딱 한곳에만 들어 갈수있다
- 사상과정이 간단하며 비용이 저렴하다.
- 캐시 적정률이 낮다.

#### Full Associative
-  비어있는 캐시 메모리를 탐색해서 매핑하는 방식
-  데이터탐색시 모든 블럭을 순차적으로 탐색해서 가져온다.
-  충돌의 위험은 적지만 비교할 때마다 순차탐색 시간이 발생하므로 오래걸린다.

#### Set Associative
- Fully associative와 Direct mapped의 장점들을 고려하여 만들어진 방식.
- 특정 row 를 지정하여 어떤 열이라도 비어있다면 저장.
-  DMC에 비해 검색은 오래걸리지만 저장이 빠르며 Associative에 비해 저장이 느리지만 검색이 빠른 중간형.

## 우지현

### 캐시의 지역성 원리

캐시 메모리는 속도가 빠른 장치와 느린 장치 간의 속도차에 따른 병목 현상을 줄이기 위한 범용 메모리이다. 이러한 역할을 수행하기 위해서는 CPU가 어떤 데이터를 원할 것인가를 어느 정도 예측할 수 있어야 한다. 캐시의 성능은 작은 용량의 캐시 메모리에 CPU가 이후에 참조할, 쓸모 있는 정보가 어느 정도 들어있느냐에 따라 좌우되기 때문이다.

이 때 `적중률(Hit Rate)`을 극대화시키기 위해 `지역성(Locality)의 원리`를 사용한다. 지역성의 전제조건으로 프로그램은 모든 코드나 데이터를 균등하게 Access하지 않는다는 특성을 기본으로 한다. 즉, `Locality`란 기억 장치 내의 정보를 균일하게 Access하는 것이 아닌 어느 한 순간에 특정 부분을 집중적으로 참조하는 특성인 것이다.

이 데이터 지역성은 대표적으로 시간 지역성(Temporal Locality)와 공간 지역성(Spatial Locality)로 나뉜다.

- 시간 지역성 : 최근에 참조된 주소의 내용은 곧 다음에 다시 참조되는 특성
- 공간 지역성 : 대부분의 실제 프로그램이 참조된 주소와 인접한 주소의 내용이 다시 참조되는 특성

### Caching line

캐시(cache)는 프로세서 가까이에 위치하면서 빈번하게 사용되는 데이터를 놔두는 장소이다. 하지만 캐시가 아무리 가까이 있더라도 찾고자 하는 데이터가 어느 곳에 저장되어 있는지 몰라 모든 데이터를 순회해야 한다면 시간이 오래 걸리게 된다. 즉, 캐시에 목적 데이터가 저장되어 있따면 바로 접근하여 출력할 수 있어야 캐시가 의미있어진다는 것이다.

그렇기 때문에 캐시에 데이터를 저장할 때 특정 자료구조를 사용하여 `묶음`으로 저장하게 되는데 이를 `캐싱 라인`이라고 한다. 프로세스는 다양한 주소에 있는 데이터를 사용하므로 빈번하게 사용하는 데이터의 주소 또한 흩어져 있다. 따라서 캐시에 저장하는 데이터에는 데이터의 메모리 주소 등을 기록해 둔 태그를 달아놓을 필요가 있따. 이러한 태그들의 묶음을 캐싱 라인이라고 하고 메모리로부터 가져올 때도 캐싱 라인을 기준으로 가져온다. 종류로는 대표적으로 세 가지 방식이 존재한다.

#### Direct Map

![Direct Map](https://www.researchgate.net/profile/Philip-Shirvani/publication/3800962/figure/fig1/AS:669950486274049@1536740051086/Block-diagram-of-a-direct-mapped-cache.png)

- 메인 메모리를 일정한 크기의 블록으로 나누고 각각의 블록을 캐시의 정해진 위치에 매핑하는 방식
- 전체의 메인 메모리에 대하여 캐시 사이즈 단위로 나누고 나뉘어진 각각의 블록들에 대해 태그(Tag) 값을 매기게 된다.
- 세 가지 매핑 방법 중 가장 간단하며 구현도 가장 쉽다.
- 캐시 메모리에 데이터가 있는지 찾으려면 비교는 한번만 해도 되어서 빠르지만, 충돌이 그만큼 자주 일어난다는 단점이 있다.

#### Full Associative

- 태그와 관게 없이 비어있는 캐시 메모리를 탐색해서 집어넣고 데이터가 있는지 찾을 때도 순차적으로 탐색해서 가져오는 방식
- 충돌의 위험은 적겠지만 비교할 때마다 순차탐색 시간이 발생하므로 오래 걸린다.

#### Set Associative

- `Full Associative`와 `Direct Map`의 장점들을 고려하여 만들어진 방식
- 테이블을 여러 개 만들면 같은 태그의 메모리라도 다른 테이블의 태그에 저장하면 되는 원리라서 테이블의 개수에 따라 `n-way set associative`라고 부른다.
- n번만큼 탐색해서 `Direct Map`보다는 시간이 더 걸리겠지만 충돌 위험은 줄어든다.


## 김현수

### 캐시의 지역성
- 캐시가 효율적으로 동작하려면, 캐시에 저장할 데이터가 지역성을 가져야 한다.
	> 지역성이란 데이터 접근이 시간적 혹은 공간적으로 가깝게 일어나는 것을 말한다.
- 즉, 프로세스가 시간/공간적으로 유사한 데이터를 집중적으로 참조하는 성질

### 지역성의 원리 
- 캐시 메모리는 병목현상을 줄이기 위한 범용 메모리이고, 이런 역할을 수행하기 위해서는 CPU가 원하는 데이터를 어느정도 예측할 수 있어야 한다. 
- 왜냐하면 캐시의 성능을 좌우하는 것은 **작은 용량의 캐시 메모리에 CPU가 사용할 의미있는 정보가 얼마나 들어있는가** 이기 때문이다.
- 이때 Hit rate(캐시의 적중율)를 극대화 시키기 위해 지역성의 원리를 사용한다.
- 지역성의 특성은 기억장치 내의 정보를 균일하게 참조하는 것이 아닌 어느 한 순간에 특정 부분을 집중 참조하는 것이다.

### 캐시 지역성의 종류
- 시간 지역성 
	- 최근에 참조된 주소의 내용은 곧 다음에 다시 참조되는 특성
	- 따라서 캐시는 반복으로 사용되는 데이터가 많을수록 높은 효율을 보일 수 있다.
	- 메모리 상의 같은 주소에 여러 차례 읽기 쓰기를 수행할 경우, 상대적으로 작은 크기의 캐시를 사용해도 효율성을 꾀할 수 있다.
- 공간 지역성
	- 대부분의 실제 프로그램이 참조된 주소와 인접한 주소의 내용이 다시 참조되는 특성
	- CPU 캐시나 디스크 캐시의 경우 한 메모리 주소에 접근할 때 그 주소뿐 아니라 해당 블록을 전부 캐시에 가져오게 된다.
	- 이때 메모리 주소를 오름차순이나 내림차순으로 접근한다면, 캐시에 이미 저장된 같은 블록의 데이터를 접근하게 되므로 캐시의 효율성이 크게 향상된다.

### 캐싱 라인
- 캐시를 묶음으로 저장하기 위해서 사용되는 자료구조.
- 캐시 메모리의 크기는 메인 메모리보다 훨씬 작기 때문에 매핑하기 위해선 주소값 전체를 사용하지 않고 특정 값만 인덱스로 사용하고 다른 값은 태그(Tag)로 사용한다. 
	> 태그는 정확한 캐시 메모리 주소를 알기 위한 정보이며 인덱스를 결합해서 메인 메모리 주소를 찾을수 있다
- 이러한 태그들의 묶음을 캐싱 라인이라고 하고, 메모리로부터 가져올때도 캐싱 라인을 기준으로 가져온다.

### 캐싱 라인의 종류

1. Direct mapped
   - Direct mapped는 테이블이 한개라서 같은 태그는 한개의 캐시 공간만 사용할 수 있다.
    - 캐시 메모리에 데이터가 있는지 찾으려면 비교는 한번만 해도 되서 빠르지만, 충돌이 그만큼 자주 일어나는 단점이 존재한다.

2. Fully associative
    - 태그와 관계없이 비어있는 캐시 메모리를 탐색해서 집어넣고 데이터가 있는지 찾을때도 순차적으로 탐색해서 가져오는 방식이다. 
    - 충돌의 위험은 적겠지만 비교할 때마다 순차탐색 시간이 발생하므로 오래걸린다.

3. Set associative
   - Fully associative와 Direct mapped의 장점들을 고려하여 만들어진 방식이다.
    - 테이블을 여러개 만들면 같은 태그의 메모리라도 다른 테이블의 태그에 저장하면 되는 원리라서 테이블의 개수에 따라 n-way set associative라고 부른다.
    - 이렇게 하면 n번만큼 탐색해서 direct mapped보단 시간이 조금 더 걸리겠지만 충돌위험은 더 줄어들게 된다.

## 이유진
### 캐시의 지역성
- 캐시의 효율성을 높이기 위해 캐시의 적중율(Hit rate)을 극대화 시켜야 한다.
- 적중률을 극대화 하기 위해 캐시에 저장할 데이터가 지역성(Locality)을 가져야 한다.
    - 지역성이란 데이터 접근이 시간적/공간적으로 가깝게 일어나는 것
    - 지역성은 프로그램은 모든 코드나 데이터를 균등하게 접근하지 않는다는 특성을 전제조건으로 한다.
    - 즉, 지역성은 기억 장치 내의 정보를 균일하게 접근하는 것이 아닌, 어느 한 순간에 특정 부분을 집중적으로 참조하는 특성

#### Caching line
메모리의 내용을 캐시에 저장하기 위해 메모리의 데이터를 읽어와야 한다. 이때 읽어들이는 최소 단위(묶음)를 캐시라인이라고 하며, 읽어들인 데이터는 캐시의 data block을 구성한다.
