# Round Robin DNS
## 이유진
### 라운드 로빈 DNS
별도의 소프트웨어 혹은 하드웨어 로드밸런싱 장비를 사용하지 않고,  DNS만을 이용하여 도메인 레코드 정보를 조회하는 시점에서 트래픽을 분산하는 기법
웹에서 사용하는 HTTP/HTTPS 뿐 아니라 도메인을 사용하는 모든 서비스(FTP, SMTP 등)에서 사용할 수 있다.

#### DNS(Domain Name System)
네트워크 계층(L3)에서는 도메인을 IP주소로 변경하기 위해 DNS를 사용한다. 웹 사이트 접속을 위해 사용자가 도메인 주소를 입력하면, DNS가 도메인 정보를 조회해서 IP주소를 사용자에게 알려준다.

#### 라운드 로빈 DNS 원리
일반적인 도메인은 하나의 IP주소가 할당되어있지만, 하나의 도메인에 여러 개의 공인 IP주소가 할당되어있는 경우가 있다. 이러한 경우, DNS에서 레코드 정보를 조회하는 시점에 여러 IP중 라운드 로빈 형태로 하나 또는 여러 개를 선택하여 사용자에게 알려준다. 사용자는 각각의 IP에 접속하게 되므로, 자연스럽게 각 서버의 부하가 분산된다.
> 이전에는 DNS조회 결과로 1개의 IP만 반환되었지만, 최근에는 복수의 IP를 순서를 정해서 제공하고 클라이언트가 접속할 IP를 선택하도록 한다.

> (참고)   
> 권한 없는 응답의 Addresses 부분이 할당된 IP
>
> 도메인에 IP주소가 하나만 할당된 경우
> ```
> >nslookup google.com
> 서버:    kns.kornet.net
> Address:  168.126.63.1
> 
> 권한 없는 응답:
> 이름:    google.com
> Addresses:  2404:6800:4004:80f::200e
>           142.250.196.142
> ```
> 도메인에 IP주소가 여러개 할당된 경우
> ```
> >nslookup naver.com
> 서버:    kns.kornet.net
> Address:  168.126.63.1
> 
> 권한 없는 응답:
> 이름:    naver.com
> Addresses:  125.209.222.141
>           223.130.195.200
>           125.209.222.142
>           223.130.195.95
> ```

#### 장점 & 단점
- 장점
  - 적은 비용으로 트래픽을 분산할 수 있다.
  - 지리적으로 복수의 웹 서버가 멀리 떨어져 있어서 실시간으로 헬스 체크가 어려울 때 사용한다.
- 단점
  - 세션이 필요한 경우, DNS쿼리 주소가 변경되어 기본 세션이 끊어지는 경우가 발생할 수 있다. <br>=> 세션을 공유하는 기술을 사용 | 쿠키값을 이용해서 동일 서버로 접속
  - 헬스 체크 기능이 없기 때문에 목록에 있는 IP주소 중 하나가 서비스에 실패해도 DNS는 해당 IP를 계속 제공하고, 클라이언트는 작동 불가능한 서비스에 도달하려고 계속 시도하게 된다. 이는 서비스 장애로 나타날 수 있다. 따라서 무중단 서비스에서 라운드로빈 DNS를 사용하면 안 된다. <br>이러한 문제를 해결하기 위해 GLSB를 사용한다. (대략 주기적인 헬스체크를 수행하는 방식)
> **Health Check?**  
> 어플리케이션이 정상적으로 동작하는지 확인하는 것
클라이언트들이 어떤 서버를 사용할 것인지 결정하기 때문에 낮은 비용으로 여러 대의 서버로 트래픽을 분산하는 장점이 있다.
