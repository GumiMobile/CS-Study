# 프래그먼트, 생명주기, 프래그먼트 매니저

## 김현수

### 프래그먼트란?
- 앱의 전체 UI에서 어딘가에 반복적으로 재사용 가능한 부분
- 프래그먼트는 자체 레이아웃(xml파일을 정의할 수 있음)을 가질 수 있으며 자체 생명 주기를 보유한다. 또한 자체 입력 이벤트를 받으며 처리할 수 있습니다.(자체 레이아웃을 갖는 것은 선택 사항, 자체 UI가 없는 프래그먼트도 만들 수 있음)
- 프래그먼트는 독립적으로 존재할 수 없고, 반드시 Activity나 다른 프래그먼트에 호스팅되어야 한다.
	> 호스팅(hosting) = 주인 역할을 하다 / 호스팅되다 = 노예가 되다
- 따라서 프래그먼트의 뷰 계층 구조는 호스트 뷰 계층 구조의 일부가 된다.

### Activity와 프래그먼트의 서로 다른 목적성
- Activity : 앱 전체적인 사용자 인터페이스(UI)에 포함될 요소들을 배치하는 곳
- 프래그먼트 : 단일 화면이나 화면 일부에 관한 사용자 인터페이스(UI)를 정의하는데 적합하다.

### 프래그먼트의 생명주기

#### 1. Activity State : Created (액티비티 생성 시)
- onAttach()
	- Fragment가 Activity에 '붙을 때' 호출된다.
	- 자원을 가져다 쓸때 onAttach()를 오버라이드하여 사용한다.

	```java
	//Fragment에서 부모 액티비티 저장하는 법
	public void onAttach(Context context){
	   super.onAttach(context)
	   if(context instanceof MainActivity){
		  mParent = (MainActivity)context;
	   }
	}
	```

- onCreate()
	- 이 Fragment가 사용할 리소스를 초기화 한다. (UI초기화는 아님!)

- onCreateView()
	- Layout inflate와 UI를 초기화 한다.
	> - ( inflater -> 뷰를 그려주는 역할/ container -> 부모 뷰 )
	- Fragment가 인터페이스를 처음으로 그릴 때 호출된다.
	- 부모 액티비티의 onCreate()를 호출 후 실행된다.
	- 이때, 부모 액티비티의 onCreate()가 아직 끝나지 않았으니 View를 바꾸면 안된다.

- onActivityCreated()
	- 부모 액티비티의 onCreate() 종료 후 실행된다.
	- Fragment ,Activity 모두 View 생성이 완료된 상태이니 부모 액티비티의 View를 바꾸려면 여기서 바꾸면 된다.

위 onCreate()와 onCreateView(), onActivityCreated()는 최소한으로 구현해야 하는 3개의 생명 주기 메서드다.

#### 2. Activity State : Started (액티비티 생성 시)
- onStart()
	- Fragment가 화면에 표시될 때 호출된다.
	
#### 3. Activity State : Resumed (액티비티 재개 시)
- onResume()
	- Fragment가 로딩이 끝나 화면에 완전히 보였을 때 호출된다.
	
#### 4. Activity State : Paused (액티비티 일시중지 시)
- onPause()
	- 화면이 중지되면 호출된다.

#### 5. Activity State : Stopped (액티비티 중지 시)
- onStop()
	- Fragment가 종료되는 과정에서 호출된다.

#### 6. Activity State : Destroyed (액티비티 파괴 시)
Fragment를 삭제하는 경우 실행되는 함수이다.

- onDestroyView()
	- Fragment가 있던 자리에 다른 Fragment가 대체될 때 실행된다. Fragment의 View를 제거한다.

- onDestroy()
	- 리소스를 제거한다.
	- 어플이 종료되거나, 절전모드 등으로 화면이 꺼지거나, 다른 어플을 실행하는 등의 상황에 실행된다.

- onDetach()
	- 액티비티로부터 분리될 때 실행된다.

### FragmentManager
- FragmentManager은 백 스택(Back Stack) 에 프래그먼트 추가/교체/삭제 작업에 의한 변경 사항을 push 및 pop 하는 작업을 담당하는 클래스

- 하는 일
	1. 프래그먼트 트랜잭션
	프래그먼트를 추가, 삭체, 교체 등의 작업을 수행할 수 있게 해주며, 행해진 트랜잭션의 상태를 프래그먼트 백스택에 저장할 수 있도록 해준다.

	2. 액티비티와의 통신
	단일 프래그먼트에 대해 세부적인 작업 또한 가능하다. 프래그먼트 내의 구성요소들 하나하나에 접근 할 수 있도록 해준다. <br>
  액티비티에서 특정 이벤트가 발생했을 때, 프래그먼트에서 적절한 동작을 할 수 있도록 한다.
